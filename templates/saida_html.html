<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
        <title>Correlação</title>
        <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    </head>
    <body>
        <center>
            <h3>Resultado correlação da empresa: {{ dados['emp_princ'] }} </h3>
            <br>
            <ul>
                {% for item in dados['emp_comp'] %}
                    <li style="list-style-type: none;">{{ item }}: {{ dados['corr_geral'][item]['corr'] }}</li>
                {% endfor %}
            </ul>
            <br>
            <br>
            <div>
                {% for item in dados['corr_periodo'].keys() %}
                    <input type="hidden" value="{{ item }}" class="period_emp"/>
                    {% with data = dados['corr_periodo'][item] %}
                        {% for d in data %}
                            <input type="hidden" value="{{ d['json'] }}" class="period_{{ item }}"/>
                        {% endfor %}
                    {% endwith %}
                {% endfor %}
                <div id="Period" style="height: 300px; width: 100%;"></div>
            </div>

            <br>
            <br>
            <div>
                {% for item in dados['corr_prog'].keys() %}
                    <input type="hidden" value="{{ item }}" class="progress_emp"/>
                    {% with data = dados['corr_prog'][item] %}
                        {% for d in data %}
                            <input type="hidden" value="{{ d }}" id="progress_{{ item }}"/>
                        {% endfor %}
                    {% endwith %}
                {% endfor %}
                <div id="Progress" style="height: 300px; width: 100%;"></div>
            </div>

        </center>
    </body>
    <script type="text/javascript">
        window.onload = function () {

            var chart = new CanvasJS.Chart("Period", {
                animationEnabled: true,
                theme: "dark1",
                title:{
                    text: "Correlação por período de 90 dias."
                },
                axisX:{
                    valueFormatString: "DD MMM YYYY",
                    crosshair: {
                        enabled: true,
                        snapToDataPoint: true
                    }
                },
                axisY: {
                    title: "Grau Correlação",
                    crosshair: {
                        enabled: true
                    }
                },
                toolTip:{
                    shared:true
                },  
                legend:{
                    cursor:"pointer",
                    verticalAlign: "bottom",
                    horizontalAlign: "left",
                    dockInsidePlotArea: true,
                    itemclick: toogleDataSeries
                },
                data: [{
                    type: "line",
                    showInLegend: true,
                    name: "Total Visit",
                    markerType: "square",
                    xValueFormatString: "DD MMM YYYY",
                    color: "#F08080",
                    dataPoints: [
                        { x: new Date(2017, 0, 3), y: 650 },
                        { x: new Date(2017, 0, 4), y: 700 },
                        { x: new Date(2017, 0, 5), y: 710 },
                        { x: new Date(2017, 0, 6), y: 658 },
                        { x: new Date(2017, 0, 7), y: 734 },
                        { x: new Date(2017, 0, 8), y: 963 },
                        { x: new Date(2017, 0, 9), y: 847 },
                        { x: new Date(2017, 0, 10), y: 853 },
                        { x: new Date(2017, 0, 11), y: 869 },
                        { x: new Date(2017, 0, 12), y: 943 },
                        { x: new Date(2017, 0, 13), y: 970 },
                        { x: new Date(2017, 0, 14), y: 869 },
                        { x: new Date(2017, 0, 15), y: 890 },
                        { x: new Date(2017, 0, 16), y: 930 }
                    ]
                },
                {
                    type: "line",
                    showInLegend: true,
                    name: "Unique Visit",
                    lineDashType: "dash",
                    dataPoints: [
                        { x: new Date(2017, 0, 3), y: 510 },
                        { x: new Date(2017, 0, 4), y: 560 },
                        { x: new Date(2017, 0, 5), y: 540 },
                        { x: new Date(2017, 0, 6), y: 558 },
                        { x: new Date(2017, 0, 7), y: 544 },
                        { x: new Date(2017, 0, 8), y: 693 },
                        { x: new Date(2017, 0, 9), y: 657 },
                        { x: new Date(2017, 0, 10), y: 663 },
                        { x: new Date(2017, 0, 11), y: 639 },
                        { x: new Date(2017, 0, 12), y: 673 },
                        { x: new Date(2017, 0, 13), y: 660 },
                        { x: new Date(2017, 0, 14), y: 562 },
                        { x: new Date(2017, 0, 15), y: 643 },
                        { x: new Date(2017, 0, 16), y: 570 }
                    ]
                }]
            });
            chart.render();

            function toogleDataSeries(e){
                if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                    e.dataSeries.visible = false;
                } else{
                    e.dataSeries.visible = true;
                }
                chart.render();
            }
        }

        function format_date(date){
            var parts = date.split('/');
            return new Date(parts[0], parts[1] - 1, parts[2]);
        }

        function color(){
            colors = ['Black', 'Navy', 'DarkBlue', 'MediumBlue', 'Blue', 'DarkGreen', 'Green', 'Teal', 'DarkCyan', 'DeepSkyBlue', 'DarkTurquoise',
                      'MediumSpringGreen', 'Lime', 'SpringGreen', 'Aqua', 'Cyan', 'MidnightBlue', 'DodgerBlue', 'LightSeaGreen', 'ForestGreen', 'SeaGreen',
                      'DarkSlateGray', 'DarkSlateGrey', 'LimeGreen', 'MediumSeaGreen', 'Turquoise', 'RoyalBlue', 'SteelBlue', 'DarkSlateBlue', 'MediumTurquoise',
                      'Indigo', 'DarkOliveGreen', 'CadetBlue', 'CornflowerBlue', 'RebeccaPurple', 'MediumAquaMarine', 'DimGray', 'DimGrey', 'SlateBlue',
                      'OliveDrab', 'SlateGray', 'SlateGrey', 'LightSlateGray', 'LightSlateGrey', 'MediumSlateBlue', 'LawnGreen', 'Chartreuse', 'Aquamarine',
                      'Maroon', 'Purple', 'Olive', 'Gray', 'Grey', 'SkyBlue', 'LightSkyBlue', 'BlueViolet', 'DarkRed', 'DarkMagenta', 'SaddleBrown',
                      'DarkSeaGreen', 'LightGreen', 'MediumPurple', 'DarkViolet', 'PaleGreen', 'DarkOrchid', 'YellowGreen', 'Sienna', 'Brown', 'DarkGray',
                      'DarkGrey', 'LightBlue', 'GreenYellow', 'PaleTurquoise', 'LightSteelBlue', 'PowderBlue', 'FireBrick', 'DarkGoldenRod', 'MediumOrchid',
                      'RosyBrown', 'DarkKhaki', 'Silver', 'MediumVioletRed', 'IndianRed', 'Peru', 'Chocolate', 'Tan', 'LightGray', 'LightGrey', 'Thistle',
                      'Orchid', 'GoldenRod', 'PaleVioletRed', 'Crimson', 'Gainsboro', 'Plum', 'BurlyWood', 'LightCyan', 'Lavender', 'DarkSalmon', 'Violet',
                      'PaleGoldenRod', 'LightCoral', 'Khaki', 'AliceBlue', 'HoneyDew', 'Azure', 'SandyBrown', 'Wheat', 'Beige', 'WhiteSmoke', 'MintCream',
                      'GhostWhite', 'Salmon', 'AntiqueWhite', 'Linen', 'LightGoldenRodYellow', 'OldLace', 'Red', 'Fuchsia', 'Magenta', 'DeepPink', 'OrangeRed',
                      'Tomato', 'HotPink', 'Coral', 'DarkOrange', 'LightSalmon', 'Orange', 'LightPink', 'Pink', 'Gold', 'PeachPuff', 'NavajoWhite', 'Moccasin',
                      'Bisque', 'MistyRose', 'BlanchedAlmond', 'PapayaWhip', 'LavenderBlush', 'SeaShell', 'Cornsilk', 'LemonChiffon', 'FloralWhite', 'Snow',
                      'Yellow', 'LightYellow', 'Ivory', 'White']
            var rand = Math.random();
            rand *= colors.length;
            rand = Math.floor(rand);
            return colors[rand]
        }

        // function dados_grafico(){
        //     period_emp = document.getElementsByClassName('period_emp')
        //     progress_emp = document.getElementsByClassName('progress_emp')

        //     period = []
        //     progress = []

        //     for(var i=0; i < period_emp.length; i++){
        //         tmp = []
        //         document.getElementsByClassName()
        //         // for(var j=0; j < )
        //         //     format_date(document.getElementById('period_fim_' + period_emp[i].value)),
        //         //     document.getElementById('period_corr_' + period_emp[i].value),
        //         //     period_var = document.getElementById('period_var_' + period_emp[i].value)
        //         //     if (period_var == 0){
        //         //         obj = {
        //         //             x: x, y: y, markerColor: "blue", markerType: "square"
        //         //         }
        //         //     } else if (period_var > 0){
        //         //         obj = {
        //         //             x: x, y: y, indexLabel: "Subida", markerColor: "green", markerType: "triangle"
        //         //         }
        //         //     } else {
        //         //         obj = {
        //         //             x: x, y: y, indexLabel: "Queda", markerColor: "red", markerType: "triangle"
        //         //         }
        //         //     }
        //         //     tmp.push(obj);

        //         obj{
        //             type: "line",
        //             showInLegend: true,
        //             name: period_emp[i].value,
        //             xValueFormatString: "DD MMM YYYY",
        //             color: color()
        //         }
        //     }
        // }

    </script>
</html>
